<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <%- include('./partials/style') %>
        <%- include('../styles/main') %>
        <style>
            p strong {
                color: #171717;
            }
        </style>
    </head>
    <body>
        <div style="margin-bottom: 20px;">
            <span class="bold" style="font-size: 16px;">VENDAS</span>
        </div>
        <% if (data.total) { %>
            <div style="border: 2px solid #000; padding: 32px; margin-bottom: 32px;">
                <p class="text uppercase p-b-sm">Valor Total em Vendas</p>
                <p class="bold" style="font-size: 36px;"><%= utils.moneyFormat(total) %></p>
            </div>
        <% } %>
        <div style="margin-bottom: 32px;">
            <p class="bold" style="font-size: 14px; padding-bottom: 20px;">VENDAS POR FUNCIONÁRIO</p>
            <table class="table-dataset nowrap">
                <thead>
                    <tr>
                        <th class="left">Funcionário</th>
                        <th class="right">Total %</th>
                        <th class="right">Valor Vendido</th>
                    </tr>
                </thead>
                <tbody>
                    <% (data.items || []).forEach(item => { %>
                        <tr>
                            <td class="left" style="color: #171717;"><%= item.nomeVendedor %></td>
                            <td class="right" style="color: #525252;"><%= item.percentVendas || 0 %>%</td>
                            <td class="right medium"><%= utils.moneyFormat(item.valorVendido) %></td>
                        </tr>
                    <% }) %>
                </tbody>
                <tfoot>
                    <tr>
                        <td class="left">TOTAL</td>
                        <td class="right"><%= data.items ? ((data.items || []).reduce((s, i) => s + i.percentVendas, 0) || 0) + "%" : '—' %></td>
                        <td class="right"><%= data.items ? utils.moneyFormat((data.items || []).reduce((s, i) => s + i.valorVendido, 0) || 0) : '—' %></td>
                    </tr>
                </tfoot>
            </table>
        </div>
        <div style="border: 1px solid #D4D4D4; padding: 20px; padding-right: 28px; background-color: #FAFAFA; color: #404040; font-size: 12px; line-height: 1.625;">
            <p class="bold uppercase p-b-md" style="color: #171717;">Observações do Período</p>
            <p class="p-b-sm"><strong>Desempenho geral:</strong> O período registrou vendas totais de <%= utils.moneyFormat(total) %>, distribuídas entre <%= (data.items?.length || 0) %> vendedores ativos.</p>
            <% const destaque = data.items?.find(v => v.vendedorDestaque?.toLowerCase() === 's') %>
            <% if (destaque) { %><p class="p-b-sm"><strong>Destaque:</strong> <%= destaque.nomeVendedor %> liderou o período com <%= destaque.percentVendas %>% do volume total de vendas.</p><% } %>
            <%# <p><strong>Distribuição:</strong> A equipe comercial demonstrou performance equilibrada, com todos os vendedores contribuindo de forma significativa para o resultado do mês.</p> %>
        </div>
    </body>
</html>
